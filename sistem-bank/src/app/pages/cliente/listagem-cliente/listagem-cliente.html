<div class="container-fluid py-4">
  <!-- Header responsivo -->
  <div class="row align-items-center mb-4">
    <div class="col-12 col-md-8 mb-3 mb-md-0">
      <h1 class="page-title mb-0">Listagem de Clientes</h1>
      <p class="text-muted mt-1 d-none d-md-block">Gerencie todos os clientes cadastrados no sistema</p>
    </div>
    <div class="col-12 col-md-4 text-md-end">
      <button
        mat-raised-button
        color="primary"
        routerLink="/cliente/novo"
        class="btn-novo-cliente w-100 w-md-auto">
        <mat-icon class="me-2">add</mat-icon>
        <span class="d-inline d-sm-none">Novo</span>
        <span class="d-none d-sm-inline">Novo Cliente</span>
      </button>
    </div>
  </div>

  <!-- Loading state -->
  <div *ngIf="loading()" class="text-center py-5">
    <mat-spinner diameter="40"></mat-spinner>
    <p class="mt-3 text-muted">Carregando clientes...</p>
  </div>

  <!-- Tabela Desktop -->
  <div class="d-none d-lg-block" *ngIf="!loading()">
    <div class="table-container">
      <table mat-table [dataSource]="dataSource" class="w-100">
        <!-- Coluna ID -->
        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef>ID</th>
          <td mat-cell *matCellDef="let element">
            <span class="id-badge">#{{element.id}}</span>
          </td>
        </ng-container>

        <!-- Coluna Nome -->
        <ng-container matColumnDef="nome">
          <th mat-header-cell *matHeaderCellDef>Nome</th>
          <td mat-cell *matCellDef="let element">
            <div class="nome-cell">
              <span class="nome-principal">{{element.nome}}</span>
            </div>
          </td>
        </ng-container>

        <!-- Coluna CPF -->
        <ng-container matColumnDef="cpf">
          <th mat-header-cell *matHeaderCellDef>CPF</th>
          <td mat-cell *matCellDef="let element">{{element.cpf}}</td>
        </ng-container>

        <!-- Coluna Email -->
        <ng-container matColumnDef="email">
          <th mat-header-cell *matHeaderCellDef>Email</th>
          <td mat-cell *matCellDef="let element">
            <a href="mailto:{{element.email}}" class="email-link">{{element.email}}</a>
          </td>
        </ng-container>

        <!-- Coluna Status -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Status</th>
          <td mat-cell *matCellDef="let element">
            <span class="status-badge" [class.ativo]="element.ativo" [class.inativo]="!element.ativo">
              {{element.ativo ? 'Ativo' : 'Inativo'}}
            </span>
          </td>
        </ng-container>

        <!-- Coluna Funções -->
        <ng-container matColumnDef="funcoes">
          <th mat-header-cell *matHeaderCellDef>Ações</th>
          <td mat-cell *matCellDef="let element">
            <div class="action-buttons">
              <button
                mat-icon-button
                [routerLink]="'/cliente/editar/' + element.id"
                matTooltip="Editar cliente"
                class="action-btn edit-btn">
                <mat-icon>edit</mat-icon>
              </button>
              <button
                mat-icon-button
                (click)="deletarCliente(element.id)"
                matTooltip="Excluir cliente"
                class="action-btn delete-btn">
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>
  </div>

  <!-- Cards Mobile/Tablet -->
  <div class="d-lg-none" *ngIf="!loading()">
    <div class="row">
      <div class="col-12 col-md-6 mb-3" *ngFor="let cliente of dataSource.data; trackBy: trackById">
        <div class="card cliente-card h-100">
          <div class="card-body">
            <!-- Header do card -->
            <div class="d-flex justify-content-between align-items-start mb-3">
              <div>
                <h6 class="card-title mb-1">{{cliente.nome}}</h6>
                <small class="text-muted">#{{cliente.id}}</small>
              </div>
              <span class="status-badge" [class.ativo]="cliente.ativo" [class.inativo]="!cliente.ativo">
                {{cliente.ativo ? 'Ativo' : 'Inativo'}}
              </span>
            </div>

            <!-- Informações do cliente -->
            <div class="cliente-info mb-3">
              <div class="info-item">
                <mat-icon class="info-icon">badge</mat-icon>
                <span class="info-text">{{cliente.cpf}}</span>
              </div>
              <div class="info-item">
                <mat-icon class="info-icon">email</mat-icon>
                <a href="mailto:{{cliente.email}}" class="info-text email-link">{{cliente.email}}</a>
              </div>
            </div>

            <!-- Ações -->
            <div class="d-flex gap-2">
              <button
                mat-stroked-button
                color="primary"
                [routerLink]="'/cliente/editar/' + cliente.id"
                class="flex-fill">
                <mat-icon class="me-1">edit</mat-icon>
                Editar
              </button>
              <button
                mat-stroked-button
                color="warn"
                (click)="deletarCliente(cliente.id)"
                class="flex-fill">
                <mat-icon class="me-1">delete</mat-icon>
                Excluir
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty state -->
  <div *ngIf="!loading() && dataSource.data.length === 0" class="empty-state text-center py-5">
    <mat-icon class="empty-icon mb-3">people_outline</mat-icon>
    <h4>Nenhum cliente encontrado</h4>
    <p class="text-muted mb-4">Comece cadastrando seu primeiro cliente</p>
    <button mat-raised-button color="primary" routerLink="/cliente/novo">
      <mat-icon class="me-2">add</mat-icon>
      Cadastrar Primeiro Cliente
    </button>
  </div>

  <!-- Paginação -->
  <div class="d-flex justify-content-center mt-4" *ngIf="!loading() && dataSource.data.length > 0">
    <mat-paginator
      [pageSizeOptions]="[5, 10, 20]"
      [showFirstLastButtons]="true"
      [length]="totalClientes"
      [pageIndex]="pageIndex"
      [pageSize]="pageSize"
      (page)="onPageChange($event)"
      class="responsive-paginator">
    </mat-paginator>
  </div>
</div>
